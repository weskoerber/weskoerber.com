<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         !! in Vim
        
    </title><meta content="!! in Vim" property=og:title><link href=https://www.weskoerber.com/fonts.css rel=stylesheet><script async data-goatcounter=https://weskoerber.goatcounter.com/count src=https://www.weskoerber.com/js/count.js></script><noscript><img src="https://weskoerber.goatcounter.com//count?p=/posts/til/vim-bang-bang/&t=!! in Vim"></noscript><script src=https://www.weskoerber.com/js/toc.js></script><link title="Wes Koerber" href=https://www.weskoerber.com/atom.xml rel=alternate type=application/atom+xml><link href=https://www.weskoerber.com/theme/light.css rel=stylesheet><link href=https://www.weskoerber.com/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://www.weskoerber.com/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://www.weskoerber.com/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://www.weskoerber.com>Wes Koerber</a><div class=socials><a class=social href=https://github.com/weskoerber rel=me> <img alt=github src=https://www.weskoerber.com/social_icons/github.svg> </a><a class=social href=https://gitlab.com/weskoerber rel=me> <img alt=gitlab src=https://www.weskoerber.com/social_icons/gitlab.svg> </a><a class=social href=https://www.linkedin.com/in/weskoerber/ rel=me> <img alt=linkedin src=https://www.weskoerber.com/social_icons/linkedin.svg> </a><a class=social href=mailto:wes@weskoerber.com rel=me> <img alt=email src=https://www.weskoerber.com/social_icons/email.svg> </a><a class=social href=https://www.weskoerber.com/atom.xml rel=me> <img alt=rss src=https://www.weskoerber.com/social_icons/rss.svg> </a></div></div><nav><a href=https://www.weskoerber.com/posts style=margin-left:.5em>/posts</a><a href=https://www.weskoerber.com/about style=margin-left:.5em>/about</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://www.weskoerber.com/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://www.weskoerber.com/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>!! in Vim<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2025-04-12</time></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://www.weskoerber.com/posts/til/vim-bang-bang/#tl-dr>TL;DR</a><li><a href=https://www.weskoerber.com/posts/til/vim-bang-bang/#using-an-empty-range>Using an empty range</a><li><a href=https://www.weskoerber.com/posts/til/vim-bang-bang/#replacing-a-single-line>Replacing a single line</a><li><a href=https://www.weskoerber.com/posts/til/vim-bang-bang/#replacing-a-range>Replacing a range</a></ul></div><section class=body><h1 id=tl-dr>TL;DR</h1><p>Today I learned about VIM's <code>!!</code> command, and it's amazing! It works by sending the selected range to an external program's <code>stdin</code>, and replaces those lines with its <code>stdout</code>.<h1 id=using-an-empty-range>Using an empty range</h1><p>Sometimes you may want to put the contents of a file directly into you buffer, but you don't want to open up the file in a separate buffer, yank the contents, and put them in your desired buffer.<p><code>readme.txt</code><pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>This is a readme file.</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>I need this file in a buffer!</span></span></code></pre><p><code>my_buffer</code><pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>This is my buffer. I want the contents of the `readme.txt` file to go in this</span></span>
<span class=giallo-l><span>file!</span></span>
<span class=giallo-l></span>
<span class=giallo-l></span></code></pre><p>After switching to normal mode and navigating to the empty line (the last line in <code>my_buffer</code>), typing <code>!!cat readme.txt</code> will but the contents of <code>readme.txt</code> into my buffer, starting at my cursor!<p><code>my_buffer</code><pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>This is my buffer. I want the contents of the `readme.txt` file to go in this</span></span>
<span class=giallo-l><span>file!</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>This is a readme file.</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>I need this file in a buffer!</span></span></code></pre><h1 id=replacing-a-single-line>Replacing a single line</h1><p>Sometimes you want to view the content of a command's <code>stdout</code> in Vim. Usually what I do is run the command and pipe <code>stdout</code> into Vim's <code>stdin</code> (i.e. <code>vim -</code>).<p>Here's an example using the <code>!!</code> command. Say you have a JSON file that's been <a href=https://en.wikipedia.org/wiki/Minification_(programming) rel=external>minified</a> and you want to un-minify it. To accomplish this, we can use <a href=https://jqlang.org/ rel=external><code>jq</code></a> to read the file and put it's formatted JSON output into our buffer.<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=json><span class=giallo-l><span style=color:#a89984>{"</span><span style=color:#689d6a>id</span><span style=color:#a89984>":</span><span style=color:#d3869b>123</span><span style=color:#a89984>,"</span><span style=color:#689d6a>name</span><span style=color:#a89984>":"</span><span style=color:#83a598>John Doe</span><span style=color:#a89984>","</span><span style=color:#689d6a>age</span><span style=color:#a89984>":</span><span style=color:#d3869b>34</span><span style=color:#a89984>,"</span><span style=color:#689d6a>address</span><span style=color:#a89984>":{"</span><span style=color:#689d6a>street</span><span style=color:#a89984>":"</span><span style=color:#83a598>123 Fake St</span><span style=color:#a89984>","</span><span style=color:#689d6a>city</span><span style=color:#a89984>":"</span><span style=color:#83a598>Nowhere</span><span style=color:#a89984>","</span><span style=color:#689d6a>zip</span><span style=color:#a89984>":"</span><span style=color:#83a598>98765</span><span style=color:#a89984>"},"</span><span style=color:#689d6a>hobbies</span><span style=color:#a89984>":["</span><span style=color:#83a598>coding</span><span style=color:#a89984>","</span><span style=color:#83a598>gaming</span><span style=color:#a89984>","</span><span style=color:#83a598>nothing</span><span style=color:#a89984>"],"</span><span style=color:#689d6a>active</span><span style=color:#a89984>":</span><span style=color:#d3869b>true</span><span style=color:#a89984>,"</span><span style=color:#689d6a>scores</span><span style=color:#a89984>":{"</span><span style=color:#689d6a>math</span><span style=color:#a89984>":</span><span style=color:#d3869b>95</span><span style=color:#a89984>,"</span><span style=color:#689d6a>science</span><span style=color:#a89984>":</span><span style=color:#d3869b>88</span><span style=color:#a89984>},"</span><span style=color:#689d6a>lastLogin</span><span style=color:#a89984>":"</span><span style=color:#83a598>2023-10-05T14:30:00Z</span><span style=color:#a89984>"}</span></span></code></pre><p>After switching to Vim's normal mode and putting my cursor over the line with the minified JSON, when I type <code>!!jq&lt;CR></code>, the single line of minified JSON is replaced with multiple lines of perfectly-formatted JSON -- magic!<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=json><span class=giallo-l><span style=color:#a89984>{</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>id</span><span style=color:#a89984>":</span><span style=color:#d3869b> 123</span><span style=color:#a89984>,</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>name</span><span style=color:#a89984>": "</span><span style=color:#83a598>John Doe</span><span style=color:#a89984>",</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>age</span><span style=color:#a89984>":</span><span style=color:#d3869b> 34</span><span style=color:#a89984>,</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>address</span><span style=color:#a89984>": {</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#689d6a>street</span><span style=color:#a89984>": "</span><span style=color:#83a598>123 Fake St</span><span style=color:#a89984>",</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#689d6a>city</span><span style=color:#a89984>": "</span><span style=color:#83a598>Nowhere</span><span style=color:#a89984>",</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#689d6a>zip</span><span style=color:#a89984>": "</span><span style=color:#83a598>98765</span><span style=color:#a89984>"</span></span>
<span class=giallo-l><span style=color:#a89984>  },</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>hobbies</span><span style=color:#a89984>": [</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#83a598>coding</span><span style=color:#a89984>",</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#83a598>gaming</span><span style=color:#a89984>",</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#83a598>nothing</span><span style=color:#a89984>"</span></span>
<span class=giallo-l><span style=color:#a89984>  ],</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>active</span><span style=color:#a89984>":</span><span style=color:#d3869b> true</span><span style=color:#a89984>,</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>scores</span><span style=color:#a89984>": {</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#689d6a>math</span><span style=color:#a89984>":</span><span style=color:#d3869b> 95</span><span style=color:#a89984>,</span></span>
<span class=giallo-l><span style=color:#a89984>    "</span><span style=color:#689d6a>science</span><span style=color:#a89984>":</span><span style=color:#d3869b> 88</span></span>
<span class=giallo-l><span style=color:#a89984>  },</span></span>
<span class=giallo-l><span style=color:#a89984>  "</span><span style=color:#689d6a>lastLogin</span><span style=color:#a89984>": "</span><span style=color:#83a598>2023-10-05T14:30:00Z</span><span style=color:#a89984>"</span></span>
<span class=giallo-l><span style=color:#a89984>}</span></span></code></pre><h1 id=replacing-a-range>Replacing a range</h1><p>Here's another contrived example. You have a list of strings and you need to sort them and edit them in a buffer. Let's ignore that Vim has a built-in sort command (<code>:h sort</code>), so we need to use <code>sort</code> from GNU coreutils. One way you might accomplish this task is:<ol><li>save the list of strings to a file<li>run GNU <code>sort</code> on the file, saving the output to a separate file<li>open the sorted file in Vim<li>yank the sorted lines<li>put the sorted lines into the desired location in your destination buffer</ol><p>This is a pretty lengthy task. Maybe we can shorten it. How about we:<ol><li>save the list of strings to a file<li>run GNU <code>sort</code> on the file, piping the output to Vim's <code>stdin</code> (<code>vim -</code>)<li>yank the sorted lines<li>put the sorted lines into the desired location in your destination buffer</ol><p>That's better- we got rid of the intermediate file containing our sorted strings, but it's still a bit lengthy.<p>There's probably some other ways you can accomplish this process a bit quicker, but instead of going over every possible scenario, let's see how you'd do this with the <code>!!</code> command:<ol><li>using the range of strings, run <code>!!sort</code></ol><p>Yep, that's it. One step. Let's have a closer look.<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>Here are some notes. I need these to keep organized!</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>TO-DO List:</span></span>
<span class=giallo-l><span>- fix the leaky faucet</span></span>
<span class=giallo-l><span>- walk the dog</span></span>
<span class=giallo-l><span>- take out the trash</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>Grocery List:</span></span>
<span class=giallo-l><span>- milk</span></span>
<span class=giallo-l><span>- ground beef</span></span>
<span class=giallo-l><span>- butter</span></span>
<span class=giallo-l><span>- eggs</span></span></code></pre><p>Let's say I want to sort my grocery list- I think it'll be easier to take inventory of what I need if it's in alphabetical order. I'll position my cursor on the "butter" line in my grocery list and -- in normal mode -- type <code>4!!sort&lt;CR></code>. <em>Et voil√†</em> -- my grocery list is now sorted:<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>Here are some notes. I need these to keep organized!</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>TO-DO List:</span></span>
<span class=giallo-l><span>- fix the leaky faucet</span></span>
<span class=giallo-l><span>- walk the dog</span></span>
<span class=giallo-l><span>- take out the trash</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>Grocery List:</span></span>
<span class=giallo-l><span>- butter</span></span>
<span class=giallo-l><span>- eggs</span></span>
<span class=giallo-l><span>- ground beef</span></span>
<span class=giallo-l><span>- milk</span></span></code></pre></section></article></main></div>