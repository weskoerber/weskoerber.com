<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Securing .env files
        
    </title><meta content="Securing .env files" property=og:title><link href=https://www.weskoerber.com/fonts.css rel=stylesheet><script async data-goatcounter=https://weskoerber.goatcounter.com/count src=https://www.weskoerber.com/js/count.js></script><noscript><img src="https://weskoerber.goatcounter.com//count?p=/posts/blog/securing-env/&t=Securing .env files"></noscript><script src=https://www.weskoerber.com/js/toc.js></script><link title="Wes Koerber" href=https://www.weskoerber.com/atom.xml rel=alternate type=application/atom+xml><link href=https://www.weskoerber.com/theme/light.css rel=stylesheet><link href=https://www.weskoerber.com/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://www.weskoerber.com/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://www.weskoerber.com/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://www.weskoerber.com>Wes Koerber</a><div class=socials><a class=social href=https://github.com/weskoerber rel=me> <img alt=github src=https://www.weskoerber.com/social_icons/github.svg> </a><a class=social href=https://gitlab.com/weskoerber rel=me> <img alt=gitlab src=https://www.weskoerber.com/social_icons/gitlab.svg> </a><a class=social href=https://www.linkedin.com/in/weskoerber/ rel=me> <img alt=linkedin src=https://www.weskoerber.com/social_icons/linkedin.svg> </a><a class=social href=mailto:wes@weskoerber.com rel=me> <img alt=email src=https://www.weskoerber.com/social_icons/email.svg> </a><a class=social href=https://www.weskoerber.com/atom.xml rel=me> <img alt=rss src=https://www.weskoerber.com/social_icons/rss.svg> </a></div></div><nav><a href=https://www.weskoerber.com/posts style=margin-left:.5em>/posts</a><a href=https://www.weskoerber.com/about style=margin-left:.5em>/about</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://www.weskoerber.com/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://www.weskoerber.com/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Securing .env files<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2026-02-14</time></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://www.weskoerber.com/posts/blog/securing-env/#overview>Overview</a><li><a href=https://www.weskoerber.com/posts/blog/securing-env/#reverse-proxy>Reverse Proxy</a><li><a href=https://www.weskoerber.com/posts/blog/securing-env/#deploying>Deploying</a><li><a href=https://www.weskoerber.com/posts/blog/securing-env/#shell-fu>Shell-fu</a><li><a href=https://www.weskoerber.com/posts/blog/securing-env/#implementation>Implementation</a></ul></div><section class=body><h1 id=overview>Overview</h1><p>Recently I've been toying around with a small homelab. I have an Intel NUC that was gifted to me by a friend and have been running a suite of Docker containers. I have a private <a href=https://about.gitea.com/ rel=external>Gitea</a> server where I can put shitty code that I don't want anyone to see; I have <a href=https://actualbudget.org/ rel=external>Actual Budget</a> running where I can track my finances (I finally said "bye" to <a href=https://www.ynab.com/ rel=external>YNAB</a> after <a href=https://www.reddit.com/r/ynab/comments/1ik8su5/ynab_pricing_history_2016_2025/ rel=external>yet another price increase</a><sup class=footnote-reference><a href=#1>1</a></sup>); Pi-hole, where I can see just how many requests are spent on analytics, ads, tracking, and other shit; and a couple others).<h1 id=reverse-proxy>Reverse Proxy</h1><p>My homelab is not directly accessible from the internet. Instead, I have a $11/year - yes, $11 <strong>per year</strong><sup class=footnote-reference><a href=#2>2</a></sup> <sup class=footnote-reference><a href=#3>3</a></sup> - <a href="https://my.racknerd.com/aff.php?aff=13788&pid=903" rel=external>RackNerd VPS</a> running <a href=https://pangolin.net/ rel=external>Pangolin</a>, <a href=https://www.crowdsec.net/ rel=external>Crowdsec</a>, and <a href=https://traefik.io/traefik rel=external>Traefik</a>. In my homelab, I run a <a href=https://docs.pangolin.net/manage/sites/install-site rel=external>Newt</a> container that makes an outbound connection to Pangolin, which then make services available. Pangolin also provides access control to secure access to these services. It's essentially an open-source <a href=https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/ rel=external>Cloudflare Tunnel</a>.<h1 id=deploying>Deploying</h1><p>I have a repository that contains all my services in <a href=https://docs.docker.com/compose/ rel=external>Docker Compose</a> files. These services have <code>.env</code> files that define secrets, such as Wireguard keys, passwords, API Keys, etc. From my home PC, I set up a docker <a href=https://docs.docker.com/engine/manage-resources/contexts/ rel=external>context</a> that allows me to manage the Docker daemon running in my homelab. This works great, because I can just switch to my homelab's Docker context, start or stop services, and not have to worry about <code>scp</code>ing source files or anything. Plus, all my secrets are in my <code>.env</code> files, so I'm not committing any secrets to source control.<p>However, there's one problem with this: all my secrets in my <code>.env</code> files exist only on my home PC. If I'm on-the-go and need to work on my homelab from my laptop, I don't have my <code>.env</code> files.<p>There are many different ways to securely share <code>.env</code> files between teams, but it's just me here. No one else is going to be working on my homelab. So with that fact, and the fact that my Gitea server is private, it would probably be just fine to commit my <code>.env</code> files to VCS.<p>But I don't wanna do that. I want to securely share my <code>.env</code> files between machines, and I don't want to learn a new service, like <a href=https://www.hashicorp.com/en/products/vault rel=external>HashiCorp Vault</a> or <a href=https://cloud.google.com/security/products/secret-manager rel=external>Google's Secrets Manager</a>, and I <em>certainly</em> don't want to pay for it. So, I came up with an alternative.<p>I present to you: <a href=https://www.gnupg.org/ rel=external>GnuPG</a>!<p>Okay, I'm probably not the first person to think of this, but I came up with the idea on my own at least.<p>Essentially, I find all my <code>.env</code> files, combine them into a single file, encrypt them, and save that encrypted file to version control.<h1 id=shell-fu>Shell-fu</h1><p>Here's a one-liner I use:<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=shellscript><span class=giallo-l><span style=color:#fabd2f>fd</span><span style=color:#d3869b> -HI -t</span><span style=color:#b8bb26> f .env</span><span style=color:#d3869b> -X</span><span style=color:#b8bb26> tail</span><span style=color:#d3869b> -v -c</span><span style=color:#b8bb26> +0 {}</span><span style=color:#8ec07c> |</span><span style=color:#fabd2f> gpg</span><span style=color:#d3869b> --output</span><span style=color:#b8bb26> env.gpg</span><span style=color:#d3869b> --encrypt --recipient</span><span style=color:#b8bb26> wes@weskoerber.com</span></span></code></pre><p>Here's a quick breakdown of that command:<ul><li><code>fd</code>: <a href=https://github.com/sharkdp/fd rel=external>fd</a> is a better alternative to <a href=https://www.gnu.org/software/findutils/manual/html_mono/find.html rel=external>GNU find</a>. If you don't have it, you should really check it out.<li><code>-HI</code>: Include hidden files, and files that are ignored by VCS.<li><code>-t f</code>: Include files only in the results (exclude directories, block devices, etc.).<li><code>.env</code>: Find files named <code>.env</code>.<li><code>-X</code>: Run the following command, passing <em>all</em> results to the command.<li><code>tail -v -c +0</code>: print the file to <code>stdout</code> (<code>tail</code>), always printing filename headers (<code>-v</code>), starting at byte 0 (<code>-c +0</code>), with the files <code>{}</code> (passed from <code>fd</code>).<li><code>| gpg --output env.gpg --encrypt --recipient wes@weskoerber.com</code>: Pass <code>tail</code>'s output to <code>gpg</code> and encrypt the file, saving it to <code>env.gpg</code>.</ul><p>Here's a quick demo of that <code>tail</code> command:<pre class=giallo style=color:#ebdbb2;background-color:#282828><code data-lang=plain><span class=giallo-l><span>$ ls</span></span>
<span class=giallo-l><span>hello  world</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>$ tail -v -c +0 *</span></span>
<span class=giallo-l><span>==> hello &lt;==</span></span>
<span class=giallo-l><span>hello</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span>==> world &lt;==</span></span>
<span class=giallo-l><span>world</span></span></code></pre><p>Pretty neat, huh? With <code>-c +0</code>, <code>tail</code> is basically functioning as <code>cat</code> here, but it prints the name of the file before its contents. This allows me to know where the file exists, and I can parse that and write the contents to the appropriate location.<h1 id=implementation>Implementation</h1><p>I created a <a href=https://codeberg.org/weskoerber/gpgenv rel=external>repo on Codeberg</a> that contains a script I use to automate various tasks, like saving and loading secrets to and from an encrypted file. Check it out!<div class=footnote-definition id=1><sup class=footnote-definition-label>1</sup><p>I still think YNAB is a good deal. If you use it carefully, you'll probably save your subscription cost several time over if you really pay attention to and stick to your budget.</div><div class=footnote-definition id=2><sup class=footnote-definition-label>2</sup><p>This was part of an affiliate deal between RackNerd and Pangolin. See the <a href=https://docs.pangolin.net/self-host/choosing-a-vps#recommended-options rel=external>Recommended Options</a> page on Pangolin's docs for more info.</div><div class=footnote-definition id=3><sup class=footnote-definition-label>3</sup><p>I have an <a href="https://my.racknerd.com/aff.php?aff=18387" rel=external>affiliate link</a> as well, so if you'd like to support me, use it to sign up for services and I'll get a small commission. However, I'd rather you use <a href="https://my.racknerd.com/aff.php?aff=13788&pid=903" rel=external>Pangolin's affiliate link</a> instead to support them!</div></section></article></main></div>